
        -- Выбираем данные о приложениях и моделях устройств
        SELECT agg.app_id, agg.device_model, an.app_name, an.platform
        -- Из таблицы agg_data, используя псевдоним 'agg'
        FROM `data-quality-project-1.dq_data_set.agg_data` agg
        -- Присоединяем таблицу app_names, используя псевдоним 'an', по app_id
        JOIN `data-quality-project-1.dq_data_set.app_names` an ON agg.app_id = an.app_id
        -- Левое соединение с таблицей device_segments, используя псевдоним 'ds', по модели устройства с учетом регистра
        LEFT JOIN `data-quality-project-1.dq_data_set.device_segments` ds ON UPPER(agg.device_model) = UPPER(ds.device_model)
            -- Также проверяем соответствие имени приложения и платформы между app_names и device_segments
            AND an.app_name = ds.app_short AND an.platform = ds.platform
        -- Условие, выбирающее записи, для которых нет соответствующей модели устройства в device_segments
        WHERE ds.device_model IS NULL
    