{"uid":"3da425e363fd0b88","name":"test_non_target_device_segments_absent","fullName":"tests.test_v_agg_data#test_non_target_device_segments_absent","historyId":"a834721aea8e368e85caae4cd74ba41c","time":{"start":1712486046250,"stop":1712486047623,"duration":1373},"description":"\nТест проверяет отсутствие записей с нецелевыми сегментами устройств в представлении v_agg_data. \nНецелевые сегменты - это те, которые не указаны или явно обозначены как 'non_target_device'.\n","descriptionHtml":"<p>Тест проверяет отсутствие записей с нецелевыми сегментами устройств в представлении v_agg_data.<br />\nНецелевые сегменты - это те, которые не указаны или явно обозначены как 'non_target_device'.</p>\n","status":"failed","statusMessage":"AssertionError: Expected 0 non-target device segments, found: 75\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: redmi 13, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: redmi 5, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\nassert 75 == 0\n +  where 75 = len([('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ...])","statusTrace":"setup = (<google.cloud.bigquery.client.Client object at 0x7fc49e9d4b60>, <environment.Environment object at 0x7fc49e9d5fa0>)\n\n    @allure.story('View_Creation')\n    @allure.severity(allure.severity_level.NORMAL)\n    @allure.description(\"\"\"\n    Тест проверяет отсутствие записей с нецелевыми сегментами устройств в представлении v_agg_data.\n    Нецелевые сегменты - это те, которые не указаны или явно обозначены как 'non_target_device'.\n    \"\"\")\n    def test_non_target_device_segments_absent(setup):\n        bq_client, env = setup  # Распаковываем возвращаемые значения фикстуры\n        v_agg_data = env.get_full_table_id('v_agg_data')  # Получаем полный ID таблицы v_agg_data\n        detailed_query = f\"\"\"\n            -- Выбор модели устройства и сегмента устройства из вьюхи v_agg_data\n            SELECT device_model, device_segment\n            FROM `{v_agg_data}`\n            -- Условие фильтрации для поиска записей, где сегмент устройства не указан (NULL)\n            -- или явно указан как 'non_target_device'. Это условие помогает найти\n            -- нецелевые сегменты устройств, которые потенциально могут представлять\n            -- интерес для анализа или требовать дополнительных действий по коррекции данных.\n            WHERE device_segment IS NULL OR device_segment = 'non_target_device'\n        \"\"\"\n    \n        # Используем вспомогательную функцию для выполнения SQL-запроса и логирования в Allure\n        detailed_results = execute_query_and_log(bq_client, detailed_query,\n                                                 \"Проверка отсутствия нецелевых сегментов устройств\",\n                                                 include_query_in_message=True)\n    \n        detailed_failures = []\n        with allure.step(\"Сбор нецелевых сегментов устройств\"):\n            for row in detailed_results:\n                if row.device_segment is None or row.device_segment == 'non_target_device':\n                    detailed_failures.append((row.device_model, row.device_segment or 'NULL'))\n    \n        with allure.step(\"Проверка, что не найдены нецелевые сегменты устройств\"):\n>           assert len(\n                detailed_failures) == 0, f\"Expected 0 non-target device segments, found: {len(detailed_failures)}\\n\" + \\\n                                         \"\\n\".join(f\"Device Model: {model}, Segment: {segment}\" for model, segment in\n                                                   detailed_failures)\nE           AssertionError: Expected 0 non-target device segments, found: 75\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: redmi 13, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: redmi 5, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE           assert 75 == 0\nE            +  where 75 = len([('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ...])\n\ntests/test_v_agg_data.py:88: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"setup","time":{"start":1712486043048,"stop":1712486043050,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\nТест проверяет отсутствие записей с нецелевыми сегментами устройств в представлении v_agg_data. \nНецелевые сегменты - это те, которые не указаны или явно обозначены как 'non_target_device'.\n","status":"failed","statusMessage":"AssertionError: Expected 0 non-target device segments, found: 75\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: redmi 13, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: redmi 5, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\nassert 75 == 0\n +  where 75 = len([('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ...])","statusTrace":"setup = (<google.cloud.bigquery.client.Client object at 0x7fc49e9d4b60>, <environment.Environment object at 0x7fc49e9d5fa0>)\n\n    @allure.story('View_Creation')\n    @allure.severity(allure.severity_level.NORMAL)\n    @allure.description(\"\"\"\n    Тест проверяет отсутствие записей с нецелевыми сегментами устройств в представлении v_agg_data.\n    Нецелевые сегменты - это те, которые не указаны или явно обозначены как 'non_target_device'.\n    \"\"\")\n    def test_non_target_device_segments_absent(setup):\n        bq_client, env = setup  # Распаковываем возвращаемые значения фикстуры\n        v_agg_data = env.get_full_table_id('v_agg_data')  # Получаем полный ID таблицы v_agg_data\n        detailed_query = f\"\"\"\n            -- Выбор модели устройства и сегмента устройства из вьюхи v_agg_data\n            SELECT device_model, device_segment\n            FROM `{v_agg_data}`\n            -- Условие фильтрации для поиска записей, где сегмент устройства не указан (NULL)\n            -- или явно указан как 'non_target_device'. Это условие помогает найти\n            -- нецелевые сегменты устройств, которые потенциально могут представлять\n            -- интерес для анализа или требовать дополнительных действий по коррекции данных.\n            WHERE device_segment IS NULL OR device_segment = 'non_target_device'\n        \"\"\"\n    \n        # Используем вспомогательную функцию для выполнения SQL-запроса и логирования в Allure\n        detailed_results = execute_query_and_log(bq_client, detailed_query,\n                                                 \"Проверка отсутствия нецелевых сегментов устройств\",\n                                                 include_query_in_message=True)\n    \n        detailed_failures = []\n        with allure.step(\"Сбор нецелевых сегментов устройств\"):\n            for row in detailed_results:\n                if row.device_segment is None or row.device_segment == 'non_target_device':\n                    detailed_failures.append((row.device_model, row.device_segment or 'NULL'))\n    \n        with allure.step(\"Проверка, что не найдены нецелевые сегменты устройств\"):\n>           assert len(\n                detailed_failures) == 0, f\"Expected 0 non-target device segments, found: {len(detailed_failures)}\\n\" + \\\n                                         \"\\n\".join(f\"Device Model: {model}, Segment: {segment}\" for model, segment in\n                                                   detailed_failures)\nE           AssertionError: Expected 0 non-target device segments, found: 75\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: redmi 13, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: redmi 5, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: None, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 13, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE             Device Model: iphone 7, Segment: non_target_device\nE           assert 75 == 0\nE            +  where 75 = len([('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ...])\n\ntests/test_v_agg_data.py:88: AssertionError","steps":[{"name":"Проверка отсутствия нецелевых сегментов устройств\n\nExecuted query:\n\n        -- Выбор модели устройства и сегмента устройства из вьюхи v_agg_data\n        SELECT device_model, device_segment\n        FROM `data-quality-project-1.dq_data_set.v_agg_data`\n        -- Условие фильтрации для поиска записей, где сегмент устройства не указан (NULL)\n        -- или явно указан как 'non_target_device'. Это условие помогает найти\n        -- нецелевые сегменты устройств, которые потенциально могут представлять\n        -- интерес для анализа или требовать дополнительных действий по коррекции данных.\n        WHERE device_segment IS NULL OR device_segment = 'non_target_device'\n    ","time":{"start":1712486046250,"stop":1712486047368,"duration":1118},"status":"passed","steps":[],"attachments":[{"uid":"d2ea1703d15f153b","name":"SQL Query","source":"d2ea1703d15f153b.txt","type":"text/plain","size":881}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"Сбор нецелевых сегментов устройств","time":{"start":1712486047368,"stop":1712486047623,"duration":255},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверка, что не найдены нецелевые сегменты устройств","time":{"start":1712486047623,"stop":1712486047623,"duration":0},"status":"failed","statusMessage":"AssertionError: Expected 0 non-target device segments, found: 75\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: redmi 13, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: redmi 5, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: None, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 13, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\n  Device Model: iphone 7, Segment: non_target_device\nassert 75 == 0\n +  where 75 = len([('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ('iphone 7', 'non_target_device'), ...])\n","statusTrace":"  File \"/tests_project/tests/test_v_agg_data.py\", line 88, in test_non_target_device_segments_absent\n    assert len(\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":3,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"story","value":"View_Creation"},{"name":"severity","value":"normal"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_v_agg_data"},{"name":"host","value":"8d3096653900"},{"name":"thread","value":"1-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_v_agg_data"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"3da425e363fd0b88.json","parameterValues":[]}