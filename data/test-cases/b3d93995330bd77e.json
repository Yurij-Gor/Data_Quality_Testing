{"uid":"b3d93995330bd77e","name":"test_v_agg_data_proper_segment_use","fullName":"tests.test_v_agg_data#test_v_agg_data_proper_segment_use","historyId":"70c5da4cf7cb15fe25bc802b4dfe99c8","time":{"start":1712870174271,"stop":1712870175560,"duration":1289},"description":"\nПроверка соответствия указанных сегментов устройств в представлении v_agg_data с сегментами, присутствующими в таблице device_segments.\n","descriptionHtml":"<p>Проверка соответствия указанных сегментов устройств в представлении v_agg_data с сегментами, присутствующими в таблице device_segments.</p>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"setup","time":{"start":1712870168365,"stop":1712870168367,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\nПроверка соответствия указанных сегментов устройств в представлении v_agg_data с сегментами, присутствующими в таблице device_segments.\n","status":"passed","steps":[{"name":"Проверка соответствия сегментов устройств\n\nExecuted query:\n\n    SELECT \n      v.device_model, \n      v.device_segment,\n      CASE \n        WHEN d.device_model IS NULL THEN 'Missing'  -- Если нет соответствия в таблице device_segments, ставим статус 'Missing'\n        ELSE 'Present'  -- Если есть соответствие, ставим статус 'Present'\n      END AS segment_status\n    FROM (\n      SELECT DISTINCT device_model, device_segment\n      FROM `data-quality-project-1.dq_data_set.v_agg_data`  -- Выбираем уникальные пары модель устройства и сегмент из v_agg_data\n      WHERE device_segment != 'non_target_device'  -- Исключаем сегмент 'non_target_device', так как он не требует проверки\n    ) AS v\n    LEFT JOIN `data-quality-project-1.dq_data_set.device_segments` AS d  -- Присоединяем таблицу device_segments\n    ON v.device_model = d.device_model AND v.device_segment = d.segment  -- Условие присоединения: совпадение модели и сегмента\n    ","time":{"start":1712870174271,"stop":1712870175216,"duration":945},"status":"passed","steps":[],"attachments":[{"uid":"7fcdf96b7cb8f988","name":"SQL Query","source":"7fcdf96b7cb8f988.txt","type":"text/plain","size":1099}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"Проверка на отсутствие недостающих сегментов устройств","time":{"start":1712870175560,"stop":1712870175560,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"story","value":"View_Creation"},{"name":"severity","value":"critical"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_v_agg_data"},{"name":"host","value":"cb7398c278e1"},{"name":"thread","value":"1-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_v_agg_data"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[],"tags":[]},"source":"b3d93995330bd77e.json","parameterValues":[]}